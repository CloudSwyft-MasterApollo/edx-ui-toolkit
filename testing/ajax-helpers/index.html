<!DOCTYPE html>
<html class="no-js" lang="en">

<head>
    <base href="/">

    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="favicon.ico">

    <title>
        
        ajax-helpers &middot; edX UI Toolkit
        
    </title>

    <meta name="description" content="A JavaScript library for building edX front end applications.">

    <link rel="stylesheet" type="text/css" href="/public/ui-toolkit.css">

</head>


<body class="doc view-testing">
<div class="doc-nav-skip sr-only">
    <a class="doc-action-skip" href="#content-main">Skip to the main content</a>
</div>

<hr class="doc-divider sr-only">

<div class="doc-wrapper-view">
    <div class="doc-wrapper-header-site">
    <header class="doc-header-site" role="banner" aria-labelledby="doc-header-site-title">
        <div class="layout-1t2t layout">
            <main class="layout-col layout-col-a">
                <h1 id="doc-header-site-title" class="hd-2 de-emphasized doc-header-site-title">
                    <a href="/">
                        <img class="doc-header-logo" src="/./static/images/edx-logo.svg"
                             alt="edX UI Toolkit home" />
                        <span>UI Toolkit</span>
                    </a>
                </h1>
            </main>
        </div>
    </header>
</div>


    <div class="doc-wrapper-content" id="content-top" tabindex="-1">
        <div class="doc-content">
            <div class="doc-wrapper-content-supplemental">
                <nav class="doc-nav doc-nav-internal" role="navigation" aria-label="edX UI Toolkit">
    <h2 class="doc-heading doc-nav-title hd-6">edX UI Toolkit</h2>
    <ul class="list-unstyled list-patterns">
        <li class="item no-indent ">
    
        <a class="pattern-title pattern pldoc-link" href="/./">
    
    Introduction
    
        </a>
    
</li>

    </ul>
</nav>


<nav class="doc-nav doc-nav-internal" role="navigation" aria-label="Utilities">
    <h2 class="doc-heading doc-nav-title hd-6">Utilities</h2>
    <ul class="list-unstyled list-patterns">
    
        <li class="item no-indent ">
    
        <a class="pattern-title pattern pldoc-link" href="/./utilities/constants/">
    
    constants
    
        </a>
    
</li>

    
        <li class="item no-indent ">
    
        <a class="pattern-title pattern pldoc-link" href="/./utilities/global-loader/">
    
    global-loader
    
        </a>
    
</li>

    
        <li class="item no-indent ">
    
        <a class="pattern-title pattern pldoc-link" href="/./utilities/html-utils/">
    
    html-utils
    
        </a>
    
</li>

    
        <li class="item no-indent ">
    
        <a class="pattern-title pattern pldoc-link" href="/./utilities/string-utils/">
    
    string-utils
    
        </a>
    
</li>

    
    </ul>
</nav>



<nav class="doc-nav doc-nav-internal" role="navigation" aria-label="Views">
    <h2 class="doc-heading doc-nav-title hd-6">Views</h2>
    <ul class="list-unstyled list-patterns">
    
        <li class="item no-indent ">
    
        <a class="pattern-title pattern pldoc-link" href="/./views/disclosure/disclosure-view/">
    
    disclosure-view
    
        </a>
    
</li>

    
        <li class="item no-indent ">
    
        <a class="pattern-title pattern pldoc-link" href="/./views/dropdown-menu/dropdown-menu-view/">
    
    dropdown-menu-view
    
        </a>
    
</li>

    
        <li class="item no-indent ">
    
        <a class="pattern-title pattern pldoc-link" href="/./views/pagination/paging-collection/">
    
    paging-collection
    
        </a>
    
</li>

    
    </ul>
</nav>



<nav class="doc-nav doc-nav-internal" role="navigation" aria-label="Testing">
    <h2 class="doc-heading doc-nav-title hd-6">Testing</h2>
    <ul class="list-unstyled list-patterns">
    
        <li class="item no-indent is-current">
    
    ajax-helpers
    
</li>

    
        <li class="item no-indent ">
    
        <a class="pattern-title pattern pldoc-link" href="/./testing/spec-helpers/">
    
    spec-helpers
    
        </a>
    
</li>

    
    </ul>
</nav>


            </div>

            <hr class="doc-divider sr-only">

            <div class="doc-wrapper-content-main">
                <main class="doc-content-main" id="content-main" aria-label="Content">
                    
                        <div class="doc-links">
                            <a rel="external" href="https://github.com/edx/edx-ui-toolkit/blob/master/src/js/utils/spec-helpers/ajax-helpers.js">
                                View on Github
                            </a>
                        </div>
                    

                    <h1 id="ajaxhelpers">AjaxHelpers</h1>

<p>These utility methods are used by Jasmine tests to create a mock server or
get reference to mock requests. In either case, the cleanup (restore) is done with
an after function.</p>

<p>This pattern is being used instead of the more common beforeEach/afterEach pattern
because we were seeing sporadic failures in the afterEach restore call. The cause of the
errors were that one test suite was incorrectly being linked as the parent of an unrelated
test suite (causing both suitesâ€™ afterEach methods to be called). No solution for the root
cause has been found, but initializing sinon and cleaning it up on a method-by-method
basis seems to work. For more details, see STUD-1264.</p>

<hr />

<h3 id="ajaxhelpersfakerequests">AjaxHelpers.fakeRequests()</h3>

<p>Keep track of all requests to a fake server, and call <code class="highlighter-rouge">spec</code>
with a reference to the server. Allows tests to respond to
individual requests.</p>

<h3 id="ajaxhelpersexpectrequestrequests-method-url-body-requestindex">AjaxHelpers.expectRequest(requests, method, url, body, requestIndex)</h3>

<p>Expect that a request was made as expected.</p>

<p><strong>Parameters</strong></p>

<p><strong>requests</strong>: , an array of fired sinon requests</p>

<p><strong>method</strong>: , the expected method of the request</p>

<p><strong>url</strong>: , the expected url of the request</p>

<p><strong>body</strong>: , the expected request body</p>

<p><strong>requestIndex</strong>: , the expected index of the request in the
    array (higher indices occur later).  Defaults to
    requests.length - 1.</p>

<h3 id="ajaxhelpersexpectjsonrequestrequests-method-url-jsonbody-requestindex">AjaxHelpers.expectJsonRequest(requests, method, url, jsonBody, requestIndex)</h3>

<p>Expect that a request with a JSON payload was made as expected.</p>

<p><strong>Parameters</strong></p>

<p><strong>requests</strong>: , an array of fired sinon requests</p>

<p><strong>method</strong>: , the expected method of the request</p>

<p><strong>url</strong>: , the expected url of the request</p>

<p><strong>jsonBody</strong>: , the expected request body as an object</p>

<p><strong>requestIndex</strong>: , the expected index of the request in the
    array (higher indices occur later).  Defaults to
    requests.length - 1.</p>

<h3 id="ajaxhelpersexpectrequesturlrequests-expectedurl-expectedparameters-requestindex">AjaxHelpers.expectRequestURL(requests, expectedUrl, expectedParameters, requestIndex)</h3>

<p>Expect that a JSON request be made with the given URL and parameters.</p>

<p><strong>Parameters</strong></p>

<p><strong>requests</strong>: , The collected requests</p>

<p><strong>expectedUrl</strong>: , The expected URL excluding the parameters</p>

<p><strong>expectedParameters</strong>: , An object representing the URL parameters</p>

<p><strong>requestIndex</strong>: , An optional index for the request (by default, the last request is used)</p>

<h3 id="ajaxhelpersexpectpostrequestrequests-url-body-requestindex">AjaxHelpers.expectPostRequest(requests, url, body, requestIndex)</h3>

<p>Intended for use with POST requests using
application/x-www-form-urlencoded.</p>

<p><strong>Parameters</strong></p>

<p><strong>requests</strong>: , an array of fired sinon requests</p>

<p><strong>url</strong>: , the expected url of the request</p>

<p><strong>body</strong>: , the expected body of the request</p>

<p><strong>requestIndex</strong>: , the expected index of the request in the
    array (higher indices occur later).  Defaults to
    requests.length - 1.</p>

<h3 id="ajaxhelpersrespondwithjsonrequests-jsonresponse-requestindex">AjaxHelpers.respondWithJson(requests, jsonResponse, requestIndex)</h3>

<p>Respond to a request with JSON.</p>

<p><strong>Parameters</strong></p>

<p><strong>requests</strong>: , an array of fired sinon requests</p>

<p><strong>jsonResponse</strong>: , an object to be serialized to the response</p>

<p><strong>requestIndex</strong>: , the expected index of the request in the
    array (higher indices occur later).  Defaults to
    requests.length - 1.</p>

<h3 id="ajaxhelpersrespondwitherrorrequests-statuscode-jsonresponse-requestindex">AjaxHelpers.respondWithError(requests, statusCode, jsonResponse, requestIndex)</h3>

<p>Respond to a request with an error status code and a JSON
payload.</p>

<p><strong>Parameters</strong></p>

<p><strong>requests</strong>: , an array of fired sinon requests</p>

<p><strong>statusCode</strong>: , the HTTP status code of the response
    (defaults to 500)</p>

<p><strong>jsonResponse</strong>: , an object to be serialized to the response</p>

<p><strong>requestIndex</strong>: , the expected index of the request in the
    array (higher indices occur later).  Defaults to
    requests.length - 1.</p>

<h3 id="ajaxhelpersrespondwithtexterrorrequests-statuscode-textresponse-requestindex">AjaxHelpers.respondWithTextError(requests, statusCode, textResponse, requestIndex)</h3>

<p>Respond to a request with an error status code.</p>

<p><strong>Parameters</strong></p>

<p><strong>requests</strong>: , an array of fired sinon requests</p>

<p><strong>statusCode</strong>: , the HTTP status code of the response
    (defaults to 500)</p>

<p><strong>textResponse</strong>: , the response body as a string</p>

<p><strong>requestIndex</strong>: , the expected index of the request in the
    array (higher indices occur later).  Defaults to
    requests.length - 1.</p>

<h3 id="ajaxhelpersrespondwithnocontentrequests-requestindex">AjaxHelpers.respondWithNoContent(requests, requestIndex)</h3>

<p>Respond to a request with an HTTP 204.</p>

<p><strong>Parameters</strong></p>

<p><strong>requests</strong>: , an array of fired sinon requests</p>

<p><strong>requestIndex</strong>: , the expected index of the request in the
    array (higher indices occur later).  Defaults to
    requests.length - 1.</p>

<hr />


                </main>
            </div>
        </div>
    </div>

    <div class="doc-wrapper-footer-site">
    <footer class="doc-footer-site">
        <div class="doc-footer-site-copyright">
            <p class="doc-copy copy-micro">
                Copyright &copy; <time datetime="2016-05-17T16:41:17-04:00">2016</time> edX.
            </p>
            <p class="doc-copy copy-micro">
                <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
            </p>
            <p class="doc-copy copy-micro">
                These works by <a xmlns:cc="http://creativecommons.org/ns#" href="http://open.edx.org" property="cc:attributionName" rel="cc:attributionURL">edX Inc.</a>
                are licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
            </p>
        </div>
    </footer>
</div>

</div>

<script src="/public/ui-toolkit-doc-factory.js"></script>

</body>
</html>

